function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function toggleFullScreen(t){document.mozFullScreen||document.webkitFullScreen?t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),resize()}function resize(){height=window.screen.height,canvas.attr("width",width).attr("height",height),pointGenerator=new PoissonDisk(width,height,radius),points=pointGenerator.generatePoints(),pointSprings.length=0,points.forEach(function(t){return pointSprings.push(new Spring(t,mass*(1+Math.random()),k+(1+Math.random()),.3*Math.random()+.5))}),voronoi=d3.voronoi().extent([[-width,-height],[2*width,2*height]]),triangles=voronoi.triangles(points)}function move(t){mousePosition=t,points.length=0,pointSprings.forEach(function(e){applyForceFromSource(e,t,300,100),e.update(),points.push(e.position)}),triangles=voronoi.triangles(points),drawTriangles(colorProfile)}function wheelColor(t,e){var n=t[0]-e[0],i=t[1]-e[1];return d3.lab(100-(n*n+i*i)/9e3,n/5,i/5)}function apteColorBlack(t,e){var n=d3.rgb(157,29,33),i=d3.rgb(167,191,209),o=d3.interpolateCubehelix(n,i),r=d3.hsl(o(distance(t,[width/2,height/2])/(diagonal/2)));return r.l+=d3.easeCircleOut(distance(t,e)/diagonal)-distance(t,e)/(diagonal/2)*4,r}function apteColorWhite(t,e){var n=d3.rgb(157,29,33),i=d3.rgb(167,191,209),o=d3.interpolateCubehelix(n,i),r=d3.hsl(o(distance(t,[width/2,height/2])/(diagonal/2)));return r.l+=d3.easeCircleOut(distance(t,e)/diagonal)-distance(t,[width/2,height/2])/(diagonal/2)/6,r}function triangleCentroid(t){return[(t[0][0]+t[1][0]+t[2][0])/3,(t[0][1]+t[1][1]+t[2][1])/3]}function applyForceFromSource(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=distance(t.position,e),r=i*n/(i+o),s=(t.position[0]-e[0])*r/o,a=(t.position[1]-e[1])*r/o;t.applyForce([s,a])}function distance(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function drawPointSprings(){context.clearRect(0,0,width,height),pointSprings.forEach(function(t){context.beginPath(),context.ellipse(t.position[0],t.position[1],2,2,0,0,2*Math.PI),context.fillStyle="black",context.fill(),context.closePath()})}function drawTriangles(t){context.clearRect(0,0,width,height),context.fillStyle="#000",context.fillRect(0,0,width,height),triangles.forEach(function(e){context.beginPath(),context.moveTo(e[2][0],e[2][1]),e.forEach(function(t){return context.lineTo(t[0],t[1])});var n=t(triangleCentroid(e),[mousePosition[0],mousePosition[1]]);context.strokeStyle=n.toString(),n.opacity=.95,context.fillStyle=n.toString(),context.fill(),context.stroke(),context.closePath()})}!function(t,e,n){function i(t,e){return typeof t===e}function o(t){var e=S.className,n=A._config.classPrefix||"";if(b&&(e=e.baseVal),A._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");e=e.replace(i,"$1"+n+"js$2")}A._config.enableClasses&&(e+=" "+n+t.join(" "+n),b?S.className.baseVal=e:S.className=e)}function r(t,e){if("object"==typeof t)for(var n in t)F(t,n)&&r(n,t[n]);else{var i=(t=t.toLowerCase()).split("."),s=A[i[0]];if(2==i.length&&(s=s[i[1]]),void 0!==s)return A;e="function"==typeof e?e():e,1==i.length?A[i[0]]=e:(!A[i[0]]||A[i[0]]instanceof Boolean||(A[i[0]]=new Boolean(A[i[0]])),A[i[0]][i[1]]=e),o([(e&&0!=e?"":"no-")+i.join("-")]),A._trigger(t,e)}return A}function s(){return"function"!=typeof e.createElement?e.createElement(arguments[0]):b?e.createElementNS.call(e,"http://www.w3.org/2000/svg",arguments[0]):e.createElement.apply(e,arguments)}function a(){var t=e.body;return t||(t=s(b?"svg":"body"),t.fake=!0),t}function l(t,n,i,o){var r,l,h,c,u="modernizr",d=s("div"),f=a();if(parseInt(i,10))for(;i--;)h=s("div"),h.id=o?o[i]:u+(i+1),d.appendChild(h);return r=s("style"),r.type="text/css",r.id="s"+u,(f.fake?f:d).appendChild(r),f.appendChild(d),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)),d.id=u,f.fake&&(f.style.background="",f.style.overflow="hidden",c=S.style.overflow,S.style.overflow="hidden",S.appendChild(f)),l=n(d,t),f.fake?(f.parentNode.removeChild(f),S.style.overflow=c,S.offsetHeight):d.parentNode.removeChild(d),!!l}function h(t,e){return!!~(""+t).indexOf(e)}function c(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-")}function u(e,n,i){var o;if("getComputedStyle"in t){o=getComputedStyle.call(t,e,n);var r=t.console;null!==o?i&&(o=o.getPropertyValue(i)):r&&r[r.error?"error":"log"].call(r,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else o=!n&&e.currentStyle&&e.currentStyle[i];return o}function d(e,i){var o=e.length;if("CSS"in t&&"supports"in t.CSS){for(;o--;)if(t.CSS.supports(c(e[o]),i))return!0;return!1}if("CSSSupportsRule"in t){for(var r=[];o--;)r.push("("+c(e[o])+":"+i+")");return r=r.join(" or "),l("@supports ("+r+") { #modernizr { position: absolute; } }",function(t){return"absolute"==u(t,null,"position")})}return n}function f(t){return t.replace(/([a-z])-([a-z])/g,function(t,e,n){return e+n.toUpperCase()}).replace(/^-/,"")}function p(t,e,o,r){function a(){c&&(delete B.style,delete B.modElem)}if(r=!i(r,"undefined")&&r,!i(o,"undefined")){var l=d(t,o);if(!i(l,"undefined"))return l}for(var c,u,p,g,m,v=["modernizr","tspan","samp"];!B.style&&v.length;)c=!0,B.modElem=s(v.shift()),B.style=B.modElem.style;for(p=t.length,u=0;p>u;u++)if(g=t[u],m=B.style[g],h(g,"-")&&(g=f(g)),B.style[g]!==n){if(r||i(o,"undefined"))return a(),"pfx"!=e||g;try{B.style[g]=o}catch(t){}if(B.style[g]!=m)return a(),"pfx"!=e||g}return a(),!1}function g(t,e){return function(){return t.apply(e,arguments)}}function m(t,e,n){var o;for(var r in t)if(t[r]in e)return!1===n?t[r]:(o=e[t[r]],i(o,"function")?g(o,n||e):o);return!1}function v(t,e,n,o,r){var s=t.charAt(0).toUpperCase()+t.slice(1),a=(t+" "+E.join(s+" ")+s).split(" ");return i(e,"string")||i(e,"undefined")?p(a,e,o,r):(a=(t+" "+x.join(s+" ")+s).split(" "),m(a,e,n))}function w(t,e,i){return v(t,n,n,e,i)}var y=[],_={_version:"3.5.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){var n=this;setTimeout(function(){e(n[t])},0)},addTest:function(t,e,n){y.push({name:t,fn:e,options:n})},addAsyncTest:function(t){y.push({name:null,fn:t})}},A=function(){};A.prototype=_,A=new A;var C=[],S=e.documentElement,b="svg"===S.nodeName.toLowerCase(),k="Moz O ms Webkit",x=_._config.usePrefixes?k.toLowerCase().split(" "):[];_._domPrefixes=x;var T=_._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];_._prefixes=T;var F;!function(){var t={}.hasOwnProperty;F=i(t,"undefined")||i(t.call,"undefined")?function(t,e){return e in t&&i(t.constructor.prototype[e],"undefined")}:function(e,n){return t.call(e,n)}}(),_._l={},_.on=function(t,e){this._l[t]||(this._l[t]=[]),this._l[t].push(e),A.hasOwnProperty(t)&&setTimeout(function(){A._trigger(t,A[t])},0)},_._trigger=function(t,e){if(this._l[t]){var n=this._l[t];setTimeout(function(){var t;for(t=0;t<n.length;t++)(0,n[t])(e)},0),delete this._l[t]}},A._q.push(function(){_.addTest=r});var P=function(){var t=!("onblur"in e.documentElement);return function(e,i){var o;return!!e&&(i&&"string"!=typeof i||(i=s(i||"div")),e="on"+e,!(o=e in i)&&t&&(i.setAttribute||(i=s("div")),i.setAttribute(e,""),o="function"==typeof i[e],i[e]!==n&&(i[e]=n),i.removeAttribute(e)),o)}}();_.hasEvent=P;var M=function(){var e=t.matchMedia||t.msMatchMedia;return e?function(t){var n=e(t);return n&&n.matches||!1}:function(e){var n=!1;return l("@media "+e+" { #modernizr { position: absolute; } }",function(e){n="absolute"==(t.getComputedStyle?t.getComputedStyle(e,null):e.currentStyle).position}),n}}();_.mq=M;_.prefixedCSSValue=function(t,e){var n=!1,i=s("div").style;if(t in i){var o=x.length;for(i[t]=e,n=i[t];o--&&!n;)i[t]="-"+x[o]+"-"+e,n=i[t]}return""===n&&(n=!1),n};var E=_._config.usePrefixes?k.split(" "):[];_._cssomPrefixes=E;var z={elem:s("modernizr")};A._q.push(function(){delete z.elem});var B={style:z.elem.style};A._q.unshift(function(){delete B.style}),_.testAllProps=v,_.testAllProps=w,_.testProp=function(t,e,i){return p([t],n,e,i)},_.testStyles=l,A.addTest("customelements","customElements"in t),A.addTest("history",function(){var e=navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone")||"file:"===location.protocol)&&(t.history&&"pushState"in t.history)}),A.addTest("pointerevents",function(){var t=!1,e=x.length;for(t=A.hasEvent("pointerdown");e--&&!t;)P(x[e]+"pointerdown")&&(t=!0);return t}),A.addTest("postmessage","postMessage"in t),A.addTest("webgl",function(){var e=s("canvas"),n="probablySupportsContext"in e?"probablySupportsContext":"supportsContext";return n in e?e[n]("webgl")||e[n]("experimental-webgl"):"WebGLRenderingContext"in t});var O=!1;try{O="WebSocket"in t&&2===t.WebSocket.CLOSING}catch(t){}A.addTest("websockets",O),A.addTest("cssanimations",w("animationName","a",!0)),function(){A.addTest("csscolumns",function(){var t=!1,e=w("columnCount");try{(t=!!e)&&(t=new Boolean(t))}catch(t){}return t});for(var t,e,n=["Width","Span","Fill","Gap","Rule","RuleColor","RuleStyle","RuleWidth","BreakBefore","BreakAfter","BreakInside"],i=0;i<n.length;i++)t=n[i].toLowerCase(),e=w("column"+n[i]),("breakbefore"===t||"breakafter"===t||"breakinside"==t)&&(e=e||w(n[i])),A.addTest("csscolumns."+t,e)}(),A.addTest("flexbox",w("flexBasis","1px",!0)),A.addTest("picture","HTMLPictureElement"in t),A.addAsyncTest(function(){var t,e,n,i=s("img"),o="sizes"in i;!o&&"srcset"in i?(e="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",t="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",n=function(){r("sizes",2==i.width)},i.onload=n,i.onerror=n,i.setAttribute("sizes","9px"),i.srcset=t+" 1w,"+e+" 8w",i.src=t):r("sizes",o)}),A.addTest("srcset","srcset"in s("img")),A.addTest("webworkers","Worker"in t),function(){var t,e,n,o,r,s,a;for(var l in y)if(y.hasOwnProperty(l)){if(t=[],(e=y[l]).name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(n=0;n<e.options.aliases.length;n++)t.push(e.options.aliases[n].toLowerCase());for(o=i(e.fn,"function")?e.fn():e.fn,r=0;r<t.length;r++)s=t[r],1===(a=s.split(".")).length?A[a[0]]=o:(!A[a[0]]||A[a[0]]instanceof Boolean||(A[a[0]]=new Boolean(A[a[0]])),A[a[0]][a[1]]=o),C.push((o?"":"no-")+a.join("-"))}}(),o(C),delete _.addTest,delete _.addAsyncTest;for(var L=0;L<A._q.length;L++)A._q[L]();t.Modernizr=A}(window,document);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),PoissonDisk=function(){function t(e,n,i){_classCallCheck(this,t),this.width=e,this.height=n,this.radius=i}return _createClass(t,[{key:"generatePoints",value:function(){var t=[],e=[];for(e.push([Math.random()*this.width,Math.random()*this.height]);e.length>0;){for(var n=Math.floor(Math.random()*e.length),i=e[n],o=this._newPointInAnnulus(i),r=!1,s=0;s<30;s++){if(this._pointIsValid(o,e.concat(t))){r=!0;break}o=this._newPointInAnnulus(i)}r?e.push(o):(e.splice(n,1),t.push(i))}return t}},{key:"_newPointInAnnulus",value:function(t){var e=t[0],n=t[1],i=Math.random()*this.radius+this.radius,o=Math.random()*Math.PI*2;return[e+i*Math.cos(o),n+i*Math.sin(o)]}},{key:"_pointIsValid",value:function(t,e){var n=this;if(t[0]<-this.radius||t[0]>this.width+this.radius)return!1;if(t[1]<-this.radius||t[1]>this.height+this.radius)return!1;var i=!0;return e.forEach(function(e){Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))<n.radius&&(i=!1)}),i}}]),t}(),Spring=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.7;_classCallCheck(this,t),this._appliedForce=[0,0],this._previousAcceleration=[0,0],this._velocity=[0,0],this.position=e.slice(),this.base=e,this.mass=n,this.k=i,this.damping=o}return _createClass(t,[{key:"applyForce",value:function(t){this._appliedForce=t}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[];e[0]=-this.k*(this.position[0]-this.base[0]),e[1]=-this.k*(this.position[1]-this.base[1]);var n=[e[0]+this._appliedForce[0],e[1]+this._appliedForce[1]];if(this._appliedForce=[0,0],this._velocity[0]+=.5*this.damping*(this._previousAcceleration[0]+n[0]/this.mass),this._velocity[1]+=.5*this.damping*(this._previousAcceleration[1]+n[1]/this.mass),this._previousAcceleration=[n[0]/this.mass,n[1]/this.mass],this.position[0]+=this._velocity[0]+.5*n[0]/this.mass,this.position[1]+=this._velocity[1]+.5*n[1]/this.mass,t){var i={previousAccelleration:this._previousAcceleration,springForce:this._springForce,force:n,velocity:this._velocity,positionVector:[this.position[0]-this.base[0],this.position[1]-this.base[1]]};console.table(i)}}}]),t}(),Wanderer=function(){function t(e,n){_classCallCheck(this,t),this.width=e,this.height=n,this._wanderToFromStart=null,this._animationFrame,this._wandering=!1,this._alpha=3,this._distanceFromToToFrom,this._delay}return _createClass(t,[{key:"startWandering",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[Math.random()*this.width,Math.random()*this.height];this._wandering=!0,this._delay=n,this.wanderToFrom([Math.random()*this.width,Math.random()*this.height],i,e,t)}},{key:"stopWandering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._wandering=!1,t&&(window.cancelAnimationFrame(this._animationFrame),this._wanderToFromStart=null)}},{key:"wanderToFrom",value:function(t,e,n,i){var o=this;this._alpha=3*Math.random()+2|0,this._distanceFromToToFrom=this._euclideanDistance(t,e),this._animationFrame=window.requestAnimationFrame(function(r){return o._step(t,e,n,i,r)})}},{key:"_step",value:function(t,e,n,i,o){var r=this;this._wanderToFromStart||(this._wanderToFromStart=o);var s=o-this._wanderToFromStart;i(this._interpolate(t,e,Math.min(1,s/n))),s<n?this._animationFrame=window.requestAnimationFrame(function(o){return r._step(t,e,n,i,o)}):(this._wanderToFromStart=null,this._wandering&&(this._delay>0?setTimeout(function(){return r.wanderToFrom([Math.random()*r.width,Math.random()*r.height],t,n,i)},this._delay):this.wanderToFrom([Math.random()*this.width,Math.random()*this.height],t,n,i)))}},{key:"_interpolate",value:function(t,e,n){return this._distanceDownLine(e,t,this._distanceFromToToFrom*this._easeInOut(n))}},{key:"_easeInOut",value:function(t){return Math.pow(t,this._alpha)/(Math.pow(t,this._alpha)+Math.pow(1-t,this._alpha))}},{key:"_distanceDownLine",value:function(t,e,n){var i=e[1]-t[1],o=e[0]-t[0];if(0==i&&0==o)return t;var r=this._euclideanDistance(t,e),s=o-o*(r-n)/r,a=i-i*(r-n)/r;return[t[0]+s,t[1]+a]}},{key:"_euclideanDistance",value:function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}}]),t}();document.addEventListener("keydown",function(t){32==t.keyCode&&toggleFullScreen(document.getElementById("fullscreen"))});var width=window.innerWidth,height=window.innerHeight,radius=30,diagonal=distance([0,0],[width,height]),mousePosition=[width/2,height/2];d3.select("svg").attr("width",width/3);var pointGenerator=new PoissonDisk(width,height,radius),points=pointGenerator.generatePoints(),mass=4,k=2,pointSprings=[];points.forEach(function(t){return pointSprings.push(new Spring(t,mass*(1+Math.random()),k+(1+Math.random()),.3*Math.random()+.5))});var voronoi=d3.voronoi().extent([[-width,-height],[2*width,2*height]]),triangles=voronoi.triangles(points),container=document.getElementById("container"),canvas=d3.select("#fullscreen").append("canvas").attr("width",width).attr("height",height),context=canvas.node().getContext("2d"),colorProfile=apteColorWhite;container.addEventListener("click",function(){colorProfile==apteColorBlack?(resize(),d3.selectAll("svg path, svg polygon").style("fill","black").style("stroke","none"),colorProfile=apteColorWhite):(d3.selectAll("svg path, svg polygon").style("fill","white").style("stroke","none"),colorProfile=apteColorBlack)});var wanderer=new Wanderer(width,height);wanderer.startWandering(function(t){return move(t)},2e3,6e3),d3.interval(function(t){points.length=0,pointSprings.forEach(function(t){t.update(),points.push(t.position)}),triangles=voronoi.triangles(points),drawTriangles(colorProfile)},40);